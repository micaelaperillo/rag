you know it's unfortunate that politics has become so serious back when you were little it was a lot more fun you can make fun of politicians here's a politician some of you may recognize but uh it's convenient to be able to vary uh what this particular politician looks like for example we can uh go from cookie Baker to radical we can go from uh superwoman uh to Bimbo socialite like the socialite end of this there she is or we can move the slider over the other way get the bag lady uh alert asleep sad happy how do how does how does that work I don't know but I bet by the end of this hour you'll know how that works and not only that you'll understand something about uh what it takes to recognize faces it turns out that some theories of face recognition are based on the same principles that um this um that this program is based on but you can kind of guess what's happening here there are several many stored images and when I move those sliders it's interpolating amongst them so that's how that works but the main subject of today um is the this a matter of uh recognizing objects faces could be the objects but they don't have to be this could be an object that you might want to recognize and I want to talk to you a little bit about the history of uh this problem and where it stands today still not solved but it's an interesting exercise to see how the attempts at solution have evolved slowly uh over the past 30 years so slowly in fact that I think if someone told me how where how long it would take to get to where we are I uh 30 years ago I think I would have hung myself but um things do move slowly uh and it's important to see how slowly they move because they will continue to move slowly in the future and you have to understand that that's the way things work sometimes so uh to start this all off we have to go back to the um ideas of the legendary David Maher who dropped dead from leukemia in about 1980 uh I say The Gospel According to marah because he was such a um a powerful and central figure that almost anything he said was believed by a a large um collection of devotees but Mar articulated a set of ideas about how computer vision would work that started off by suggesting that with the input from the camera you form a kind of you look for edges and you find Edge fragments and normally they wouldn't be even as even as um well drawn as uh I've done them now or as badly drawn as I've done them now but uh the first step then in visual recognition would be to form this edge-based description of what's out there in the world and Mar I call that the Primal sketch from the P Primal sketch the next step was to decorate the Primal sketch with some vectors some surface normals showing where the faces on the object were oriented he called that the 2 and a2d sketch uh why is it 2 and 1 half D well it's it's sort of 2D in in in the sense that it's still camera Centric in it's its way of presenting information but at the same time it attempts to say something about the three-dimensional or or arrangement of the faces so the speculation was that you couldn't get to where you wanted to go in one step so you needed several steps to get from the image to something that you could recognize and the third step was to convert the Primal the two and half D sketch into generalized cylinders and the idea is this if you have a regular cylinder you can think of it as a as a circular area moving along an axis like so so that's a description of a cylinder a circular area moving along an axis you can get a different kind of cylinder if you go along the same axis but you allow the size of the circle to change as you go so for example if you were to describe a wine bottle there would be a function of distance along the axis that would shrink the uh the uh the circle appropriately to match the uh dimensions of a wine bottle a fine burgundy I perceive in any case this one once converted into a generalized cylinder when matched against the library of such descriptions results in recognition great Theory based on the idea that you start off by looking at edges and you end up in several steps of transformation producing something that you can look you can look up in a library of descriptions great idea trouble is no one can make it work it was too hard to do this it was to too hard to do that and the generalized cylinders produced if any were too coarse you couldn't tell the difference between a Ford and a Chevrolet or between a Volkswagen and a Cadillac because they're just two cores so although it was a great idea based on the idea that you have to do recognition in several transformations of representational representational apparatus just didn't work so much later maybe 15 years later or so uh we get to the next um the next part of our story which is the uh alignment Theory uh alignment theories most notably the one produced by Shimon Alman one of Mar's students so the um alignment theory of recognition is based on a very strange and exotic idea it doesn't seem strange and exotic to mechanical engineers for a while because they're used to Mechanical drwings but here's the strange and miraculous idea imagine this object you take three pictures of it you can reconstruct any view of that object now I have to be a little bit careful about how I say that first of all some of the vertexes are not visible in the views that you have so of course you can't do anything with those so let's say that we have a transparent object where you can see all the vertexes if you have three pictures of that you can reconstruct any view of that object now I have to be a little careful about how I say that because it's not true what's true is you can produce any view of that in orthographic projection so if you're close enough to the object that you get perspective it doesn't work but for the most part you can neglect perspective after you get about two and a half times as far away as the object is big and you can presume that you got orthographic projection so that's a strange and exotic idea so how but how can you make a recognition Theory out of that so let me show you uh here's one drawing of the object I need two more oh let's see let's have this one and maybe one that's uh tilted up a little bit it's important that these it's important that these pictures not be not be just rotations in one axis because they wouldn't form what you might think of as a kind of basis set so there are three pictures we'll call them a b and c and then we want a fourth picture which will look like this it doesn't have to be too precise and we'll call that the unknown and what we really want to know is if the unknown is the same object that these three pictures were made from so let me begin with an assertion I'll need four colors of chalk to make this assertion what I want to do is I want to I want to pick a particular place on the object like this one and maybe the same place on this object over here those are corresponding places right so I can now write in the equation that the x coordinate of that unknown object is equal to oh I don't know alpha x sub a plus Alpha plus beta I mean x sub B plus gamma x sub c plus some constant T well of course that's obviously true because I'm I'm letting you take those Alpha Beta gamma and ta and make them anything you want so although that's conspicuously obviously true it's not interesting so let me take another point and of course I can write the same equation down for this for this purple point and now that I'm on a roll and having a great deal of fun with this I can take this point and make a blue equation and you know I'm I'm destined to do it so I've got one more color I might as well use it let's just make sure I get something that works here that's this one it's this one I hope I've got these correspondences right have I got one off which one which color Okay so this one goes with this one goes with this one is that one wrong oh oh oh oh of course it's wrong excuse me goes down here right and then this one is off as well I wouldn't get a very good recognition scheme if I can't get those correspondences right which is um one of the lessons of today okay now I've got them right and now that equation is correct I think I've got this one right already so now I can just write that down I'm on a roll I could just I'm just copying this so those are a bunch of equations and now the astonishing part is that I can choose Alpha Beta gamma and T to be all the same that is there's one set of Alpha Beta gamma and ta that works for every for all four points so you look at that puzzled and that's okay to be puzzled because I certainly haven't proved it I'm asserting it but right away there's something interesting about this and that is that the relationship between the points on the unknown object and the points in the stored library of of of images are related linearly that's true because it's orthographic projection linearly related so I can generate the points in the in in in some fourth object from the points in three sample objects with u linear operations Christopher is that the x coordinate of it's the X it's the x coordinate each of those xcoord Christopher asked about the x coordinates each of these x coordinates are meant to be colorcoded it gets a little complicated with the notation and stuff uh so that's the reason I I'm color kind of color encoding the coordinates so that the so the orange ex subu is the x coordinate of that particular pointd in 3 no in in not in 3D space in the image so projection of it it's a 2d projection of it an orthographic projection okay so we're looking at drawings and those coordinates over there are the two-dimensional coordinates in the drawing just as if it were on your retina or can curve surfaces also so he ask about curv surfaces and the answer is that you have to find corresponding points on the object so if you had a curved if you have a totally curved surface and you can't identify any corresponding points you lose but if you consider our faces there are some obvious points even though our faces are not by any means flat flat like these objects we have the tip of our nose and the center of our eyeballs and so on so uh if that's true uh what does that mean about recovering Alpha Beta gamma and T can we can we find them M what do you think how we go about finding them you're nodding your head in the right direction split it it's four equations in four four linear equations and four unknowns so obviously you can solve for Alpha Beta gamma and and and T if you know that these equations are correct so how does that help us with recognition it helps us with recognition because we can take another Point let me say this Square Point here and this corresponding Square Point here and this corresponding Square point here and what can we do with those three points now we've got Alpha Beta gamma and ta so we can predict where it's going to be in the fourth image so we can predict that that square point is going to be right there and if it isn't we are highly suspicious about whether this object is the kind of object we think it is so you look at me in disbelief You' like me to demonstrate this I imagine okay let me see if I can demonstrate this so I'm going to do this um in a slightly simplified uh in a slightly simplified version I'm only going to allow rotation around the uh around the vertical axis and just so you know I'm not cheating there's a little slider here that rotates that that third object let's see why are there just two two known objects and one unknown well that's because I've restricted the motion to rotation around the vertical axis and some translation so now that I've spun that around a little bit let me pick some corresponding points oops what happened well let me run that by again okay so there's one point I've selected from the model objects and the corresponding point over here on the unknown is right there I'm going to be a little off but that's okay so let me pick that one and then uh this that corresponds to this one Christian would you like me to specify the point so people know no I'm cheat no I'm don't not cheating pick a point pick a point chrishna the right right this one oops I got to pick it on the model first I'll pick it over here boom so all the points are where they're supposed to be that cool well let's suppose that the unknown is something else this uh is a carefully selected object because the points are all the correct positions vertically um but they're not necessarily the correct position positions in the other two Dimensions so let me pick a this point and this point and this point and this point and Krishna had me pick this point so let me pick this point so if it thinks that the unknown is one of these Obelisk objects then we would expect to see all of the corresponding points correctly identified but boom all the points are off so it seems to work in this particular example I find the alpha and beta using two images and I predict the locations of the other points and I determine whether those positions are correct and if they are correct I have a pretty good idea that I have in fact identify the object on the right as either an obelisk or an organ depending on uh which the model choices and the um unknown choices I've selected so uh the only thing I have left to do is to demonstrate that what I said about this is true so I'm going to actually demonstrate that what I said about this is true uh using the configuration in this demonstration because it's much too hard for me to remember uh Matrix Transformations for generalized rotation around three in three dimensions so here's how it's going to work the um z-axis is going up that way or it's going to be pointing toward you and what I'm going to do is I'm going to rotate around this axis and what I'm going to do what I want to do is I want to find out how the x coordinate in the image of the points move as I do that rotation so here's the xais AIS this is the coordinate that you can see here is the Y AIS that's in depth so you can't tell how far away it is and the z-axis XY z- axis must be pointing out that way toward you so now I'm going to consider just a single point on the object and see what happens to it so I'm going to I'm going to say to let's put it in some kind of standard let's put the object in some kind of standard position I don't care what it is but it could be just random just spin it around some position we'll call that that the uh standard position s and that means that the x coordinate of the standard position is X subs and a y-coordinate of the standard position is a y subs and now I'm going to rot rotate the object uh three times once's to form the a picture once's to form the B picture and once to form the C picture and you can make those choices I don't you know don't have to depend those can be anything right so let's say that the um a picture is out here so that's X that's that's the a picture the B picture is out here and the unknown is up that way and so what I want to know depends on these vectors we'll call that Theta sub a and this is Theta sub B oops Yeah that's Theta sub B and this one is Theta sub U so I would like to know how uh x sub a depends on X subs and Y subs and I can never remember how to do that because I can never remember the transformation equations for rotation so I have to figure it out every time and this is no exception so what I'm going to say is that this Vector that goes out to S consists of two pieces there's the X part and the Y part and I know that I can rotate this vector by Alpha a by rotating this vector and rotating that vector and adding up the results right so if I rotate this vector by Alpha sub a then the contribution of that to the x coordinate of a is going to be given by the cosine of theta sub a multiplied by X Subs right so you can just exaggerate that Mo motion say well if I pitch it up that way then the projection down on the on the x axis is going to be this length of the vector times the coine of the angle all right now there's also going to be a dependence on y Subs let's figure out what that's going to be I've got this Vector here and I'm going to rotate it by Theta sub a as well if I rotate that by Theta sub and see what the projection is on the x- axis that's going to be given by the sign of the of the angle right but it's actually it's going the wrong way so I have to subtract it off so that's how I don't have to remember what the signs are in these equations well that was good and now I can now I'm now I'm off and running I can do what I did before it makes it easy to do give the lecture because this is going to be X to B is equal to x sub s time the cosine of theta sub B minus y sub s * the cosine of theta oh you're letting me make mistakes shame this is I can generally tell by all the troubled looks but there should be some shouting as well that's the sign and that's the sign and one more time x sub U is equal to x sub s * the cosine of theta sub uus y Subs time the S of theta sub U and I forgot the B up there so there are some equations and we don't know what we're doing we're just going to stare at them a while and see if they sing us a song so let's see if they sing us a song uh what about X of a and X of B these are things that we see in the image these are things that we can measure what about all those cosiness and SS Theta A's and Theta BS well we have no idea what they are but one thing is clear they're true for all of the points on the object because when we rotate the object around by angle Theta we're rotating all of the points the same but through the same angle right so with respect to any particular view of the object here we are in a standard position here we are in position a the vectors to all of the points on the object are rotated by the same angle when we go from the standard position to the a position so that means that for all of the all of the images in this particular rendering with a particular Rotation by Theta a Theta B and Theta U those are constants now remember this is for a particular Theta a a particular Theta b and a particular Theta U as long as we're talking about all of the points for each of those rotations those angles and Co signs are going to be the same for all possible for all possible points on the object okay so now we go back to our high school algebra experts and we say look at these first two equations we can get rid of we can we we can express we got two equations in what we can now conceive screw to be two unknowns what are the unknowns that are left we can measure a and b whatever the cosin are they're the same for all the pictures so if we treat those as constants then we can solve for x of s and Y Subs right we can solve for x subs and Y Subs in terms of x sub a and Y and X to B and and a and a whole bunch of constants but I don't know a whole bunch of constants Let's see we can gather up all those cosines and ratios of ss and cosines and all that stuff uh they're all put them all together because they're all constants and then we can do this we can say x of U is equal to well it's going to depend on X of a and X of B and by the time we wash or manipulate or screw around with all those coides uh we can say that the multiplier for XM a is some constant Alpha and the multiplier for X of B is some constant beta so that's not a slight of hand that's just linear manipulation of those equations and that's what we wanted to show that for orthographic projection which is this which this is there's no perspective involved here we're just taking the projection along the x-axis for that kind of projection then we can demonstrate for this simple situation that that equation must hold now let me I want to give you a few puzzles because this stuff is so simple suppose I allow translation as well as rotation what's going to happen just get the to yeah you add you add a constant towel but what do we need to do in order to solve the I mean sub let's see now I've got three nnes right I don't know T I don't know XS I I don't know I so I need another equation where do I get the other equation from another picture that's why up up there I needed four points that covers a situation where I've got 3 Dees of rotation and translation here I got by with just two pictures uh in this illustration that one involved a t a translational element so I need three pictures and this one's got full rotation so I needed four so um great idea uh works fine uh trouble is it doesn't work so fine on natural objects it works fine on things that are manufactured because they all have identical Dimensions so if I made a million of these in a factory I'd have no trouble recognizing them because all I'd have to do is take three pictures record coordinance of some of the points and I'd be done trouble is the natural world isn't like this and you wen't like this either I don't know if you know if I'm trying to recognize faces it's uh it's not that easy to uh to do all this first of all it's it's a little difficult to find the exact point the exactly corresponding points I made that I made a mistake in doing it myself and if the computer made a mistake it would be certainly make an error because it would be using non-corresponding points to make the predictions it would be way off but this is still in the tradition of working from the from from local features in the objects toward recognition so having having looked at that theory um we also find it a little wanting works great in some circumstances doesn't seem to solve the whole recognition problem years pass shimone Alman comes up with another theory that's not so much based on edge fragments or the location of particular features but rather on correlation taking a picture of say krishna's face taking a picture of the whole class and then using that as a kind of correlation mask running it all over the the picture of the class seeing where it maximizes out now that's fake I'll explain what I'm talking about respect to correlation in a minute but it's basically saying do I have if I have a picture of Krishna where do I find him I'll find him in one place but you know what Christian doesn't look like anybody else so I might not find any other faces and if my objective is to find all the faces then maybe that idea won't work either or to take another example here's a dollar bill we haven't had raises in quite a while so this is my last one uh it's got a picture of George Washington on it and I can look over all over the class and and if I use this as a face detector I'd be sorely disappointed because I wouldn't find any faces because thank God nobody looks exactly like George Washington so the correlation wouldn't wouldn't work very well so that idea is a loser but wait a minute I don't have to look for the whole face I could I could just look for uh eyeball for eyes and then I could look for noses and maybe mouths and maybe I could have a library of 10 different eyes and 10 different noses and 10 different mouths uh would that idea work probably not so well the trouble with that one is I'd find eyeballs in every doorknob there just not enough stuff there to uh to give me a a reliable correlation so let's uh make this a little more concrete by drawing some pictures [Music] Halloween is approaching so here's a face all right here's another face so those might be faces in my pre-recorded library of funkin faces now Along Comes This face what's going to happen well I don't know let's draw yet another face I don't know it could be a pretty weird pumpkin face I suppose but I mean it to be something it doesn't look very much like a face so if I'm doing a complete correlation with either of these faces in my library neither one will match this one very well right if I'm looking for fine features like eyes then I've got these eyes everywhere so it doesn't help very much so you can see where I'm going and you can reinvent Almond's great idea what is it we don't look for big features like whole faces we don't look for small features like individual eyes we look for intermediate features like two eyes and a nose or a mouth and a nose so when we do that then we can say well here are two eyes and a nose Ah that's found in this one and what about the U combination of that nose and that mouth oh that's over here and neither of those features can be found in the third image in the fourth image so that's the Goldilocks principle when you're doing this sort of thing you want things are not too small not too big I've got the the rumble still skin p uh the rumble still skin principle up there too by the way because I I meant to mention that uh Mar was a genius at naming things and even though uh many of his theories U have faded he's still known for these names like Primal sketch and two half sketch because he was such an artist at naming the concepts he even got credit for a lot of stuff that he didn't do uh not because he was deliberately trying to to uh to get it inappropriately but just because he was so good at naming stuff so we had the Rumple still skin principle back then and now we have the goolock principle not too big not too small but that uh leaves us with the final question which is okay so if what we want to do is look for intermediate size features uh how do we actually find them in a sea of a Sea of Faces out there see I might have a library I might take 10 of you and record your eyes take another 10 and record your mouths and they may be put together in in in a unique way for each of you out there but it's it's it's likely that I'll find W's eyes somewhere else in in the crowd and nicol's mouth somewhere else in the crow so how how do we in fact go about finding them and I mentioned the term correlation a couple of times and now let me U let me make that concrete so uh let's consider a um a one-dimensional face that looks like this that's just a signal and uh I'm going to consider a one-dimensional image and in that onedimensional image I've got a faximile of the face and the question is what kind of algorithm can I use to determine the offset in the image where the face occurs and so you can you can see that one possibility is you just do an integral of the signal in the face and the signal out here over the extent of the face and and see how it multiplies out or to make it less Lally and more MIT is let's say that what we're going to do is we're going to maximize over some parameter X the integral over X of some face which is a function of X and the image G which is a function of x minus that offset so when T when the offset T is equal to this offset then we're essentially multiplying The Thing by itself and integrating over the extent of the face and that gives you a very big number if they're lined up and a very small number if they're not and it's even true if we add a whole lot of noise to the images but these are images uh they're not one-dimensional but that's okay it's easy enough to make a modification here we're going to maximize over translation parameters X and Y and these are no longer functions of just X they're also functions of Y like so all right so that's that's basically how it works and we won't go into details about normalization and all that sort of thing because that's the stuff of which other courses uh Remain the custodians so uh would you like to see a demonstration okay let's see where all right so without realizing it Nicola and Erica have loaned us their pictures and they are embedded in that big field of noise and it's pretty easy to pick out Erica Nicola right because we are actually pretty good at at at at picking faces out of these uh out of these these images so um let's add some noise it's a little harder now what I'm going to do is I'm going to run this correlation program over this whole image using Nicholas's face as a mask and seeing where the correlation Peaks up in spite of all the noise that's in there boom there he is okay I don't know maybe we can find Erica too I forgot where she was I can't find her there she is it's a unfortunately the parameters aren't very good here do you see that do you see that let me get a another version of this just do some so we do some real time programming I've been trying to reset the parameters so that they come out so so that the images the demonstration comes out clearly up there let's see if this works a little better okay so let's add some noise and let's find Erica there she is okay there's some other things that look a little bit like Erica but nothing looks quite exactly like Erica so let's try uh Nicola's eyes so they stand out pretty clearly against the background let's see if we can fight Erica's eyes so they stand out pretty clearly against the background notice it Al gets nickel's eyes so two eyes is an intermediate size constraint it's loose enough that it will match more than one person but it's not so loose that it's as bad as looking for one eye see they're all over the place so two eyes and a nose a mouth and the nose that would be even better as an intermediate feature but it doesn't matter what the best ones are because you can work that out experimentally so that's how correlation works and it's just amazing how much noise you can add and they'll still pick out the right the right stuff there's nickola boom very clear you want to add some more noise I don't know I I can see it but that's because I'm a pretty good correlator too boom I don't know let's add some more noise it's just hell hard to get rid of it I mean it's just amazing how well it picks it out that's that's good that's cool now how could you uh but this the reason that this is 30 years and we're still not done is there's still some questions this is recognizing stuff straight on how is it I can recognize you in the hall from the side nobody knows one possibility is that you have an ability to make those Transformations if so then that alignment theory has a role to play another theory is that well after I've seen you once I can watch you turn your head and keep recording what you look like at all possible angles that would work trouble is is there enough stuff in there maybe we don't know uh what would it take to break this mechanism well I don't know let's see if we can break the mechanism um let's say you can recognize some well-known faces who's that quit oh that's too easy well we'll see if we can make some harder ones yeah that's a who's this oh boy you're really good at this that's push how about this guy okay now I've got it some people are starting to turn their heads and that's not fair that's not fair because you see what's happened is that if this if this kind of pumpkin theory is correct then when you turn the face upside down you lose the correlation of those features that have vertical vertical components so if you have two eyes and a nose they won't match two eyes and a nose when they're turned upside down well let's see I'll try some more who's that gorbachov who said that Leonid where are you gorbachov right you can recognize him because of that little birth mark on his top of his head one more who's oh that's that's easy right who's the that's uh that's Clinton how about this one you see how insulting it is to be an MIT that's me and you didn't even know oh God so uh this suggests that um this it might be evidence for the uh correlation Theory but of course turning the face upside down would make it very difficult to do alignment too so it would break an alignment Theory as well let me get that after classifi was there a mistake or no no I was just stretching would break if what would break the what stretching um Elliot asked if stretching would break the correlation and and the answer is I think stretching in the vertical Dimension is worse than stretching in the horizontal Dimension because you get a certain amount of stretching in the horizontal Dimension when you just turn your head by the way since our faces are basically mounted on a cylinder uh this kind of transformation uh might actually work that's a sidebar to the answer to your question ell but now you say well okay so this is not completely solved you can you can work this out uh but if you really want to work something out let me tell you what the current what the current questions are in computer vision people who work for an awful long time on this recognition stuff and to my mind have neglected uh the more serious questions the more serious questions are how do you visually determine what's happening if you could write a program that would reliably determine when these verbs are happening in your field of VI I will I will sign your PhD thesis tomorrow there are 48 of them there and that is today's challenge but since we're short on time I want to skip over that and perform an experiment on you I want you to tell me what I'm doing so this best single word answer is Mana okay this is not a trick question okay the best single word answer Christopher what do you think Christopher well you you toasting what toasting okay not a trick question what's Happening Here best single word answer he drinking which pair look more alike so that cat is drinking and nobody has any trouble recognizing that and I believe it's because I believe it's because you're telling a story so our power of Storytelling even reaches down into our visual apparatus so the story here is that some animal has evidently had an urge to find something to drink and water is passing passing through that animal's mouth that's the drinking story so even though they look enormously different visually the stuff at the bottom of our vision system provides enough evidence for our story apparatus so that we can give the left one and the right one different labels and recognize the cat is drinking and that's the end of the story