I have extremely bad news Halloween Falls this year on a Sunday but we in 6034 refus to suffer the slings and arrows of Outrageous Fortune so we've decided that Halloween is today as far as 6034 is concerned Kenny could you give me a hand please take that and put it over there m just give it to them you can take as much of this as you like the rest will be given to that herd of stampeding freshmen that comes in after it's a cornicopia of legal drugs chocolate um does uh produce a kind of mild high and I recommend it uh before quizzes and giving lectures it um I have a a friend of mine one of the Nobel laurates in biology always eats chocolate before he lectures give him a little Edge otherwise it would be flat so I recommend it it will take I suppose a little while to digest that neural net stuff little richer than you usual in mathematics So today we're going to talk about another effort at mimicking biology this is a u this is easy stuff it's just conceptual and you won't see this on the next Quiz but you will see it on the final it's one of those quiz five type problems where you ask you questions to see if you are here and awake so typical question might be professor professor Winston is a creationist or something like that not too hard to answer in any event um if it's been hard to develop a real understanding of intelligence occasionally the hope is that by mimicking biology or mimicking Evolution you can C circumnavigate all the problems and one of those kinds of efforts is a effort to um imitate Evolution so so we're going to talk today about so-called genetic algorithms which are naive um attempts to mimic naive Evolution now I realize that um most MIT students have a basic grasp of sexual reproduction but I found in talking with students that many times the details are a little fuzzy on some of the details so let's start off by reflecting a little bit on how that works so uh Let's see we need U pink and blue and here's our cell and here's its nucleus and here are mommy and daddy's chromosomes we'll just pretend there's one pair now ordinarily uh in ordinary uh cell division you get two cells both have a nucleus and the process of producing them involves the duplication of those Chrome chomes and then one pair ends up in each of the child cells and that's all there is to that that's mitosis but then uh when uh we talk about reproduction it's more complicated because the those chromosomes get all twisted up and they break and they recombine so when we talk about the cells that split off from one of these germ cells it's no longer appropriate to talk about the pink one and the blue one because the pink one and the blue one are all mixed up so you get two chromosomes here and two here but through some miracle of nature which has always amazed me these two cells split in turn into four cells Al together and each of those four cells at the bottom gets one of the chromosomes that was produced by that twisting up of the rope and recombination then Along Comes um Along Comes a special occasion and um now um we can think of this as being a blue one and this is being a pink one and they come together and you get a new person like so note that your mother and father's uh chromosomes are never never recombine it's your grandparents chromosomes that recombine so that's what it's like and the main thing to note about this is well are a couple things if you happen to be a female uh this part of the process this part over here took place before you were born if you happen to be male it's going on right now as we speak which probably explains something but any event is going on right now but whenever it goes on uh there are lots of opportunities for uh for throwing dice so God threw all the dice before you were born if you happen to be a female in this part of the process over here then of course more dice got thrown here when the decision was made about which particular cells got to fuse to form a new individual so I want to beat on this idea of lots of choice when we talk about genetic genetic algorithms when we talk about nature there there are lots of choices in there and that means there are lots of choices to intervene uh to screw around to make things work out the way you want but any event there we are that's the basic idea and it all starts with chromosomes so we could think of implementing something that imitates that with the um act G stuff that you learned about all about in 701 but we're computer scientists we don't like Base Four we like base two so I'm going to just suggest that our chromosomes are binary in this uh system that we're going to build so that might be a chromosome it doesn't have to be binary it can be it can be symbolic for a liare but it's just some string of things that that determine how the ultimate system behaves so it all starts out then with some of these chromosomes uh some of these uh simulated chromosomes simulated simplified and naive and there's a population of of of chromosomes the population of chromosomes that might be subject to a little bit of mutation that is to say a zero becomes a one or a one becomes a zero that happens a lot that mutation stuff happens over here when things get twisted up and recombine or copying errors and stuff Cosmic Grays hit it all the time all sorts of reasons why there might be a single single point of change that that produces the mutation effect so here we have a population it starts off over here and it's some of those things are subject to mutation and you'll know here here's a whole bunch of choice already how many of these mutations do you allow per chromosome for example uh how many of the chromosomes just slip through without any mutation those are choices you can make once you've made those choices then we have the crossover phenomenon let's identify one of these guys as the uh pink one and one of these guys as the blue one and so now we have the pink one cruising along as well as the blue one but a pink one and a blue one cross and produce a new chromosome just like in nature so we take the front part of one back part of the other and we fuse them together and some may slip by without any of that like so well these these things are meant to be combined in pairs like so but they may not they may not have any crossover in them so another yet another set of choices how many crossovers do you allow per recombination yet another set of choices so now we've got a population of um of modified chromosomes through mutation and crossover so the next thing to do is we have the genotype to phenotype transition that is to say the the chromosome determines the individual it may be a person it may be a cow it may be a computer program I don't care what but that that code down there has to be interpreted to be a something so it is the genotype and it has to be interpreted to be something which is the phenotype the thing that the that the that the stuff down there is encoding for so out here we have a bunch of individuals now each of those individuals because they have varying chromosomal composition will have a different Fitness so these fitnesses might be well who knows they might how they might be scored but we're computer scientists we might as well use numbers so maybe this guy's Fitness is 88 this guy's Fitness is 77 and so on so now that we've got Fitness uh by the way notice all the choices involved there choice of how you interpret the the genotype choice about how the phenotype produces a fitness and now we have a choice about how the fitness produces a probability like8 and point one or something like that probability of survival into the Next Generation so now once we've got those probabilities we actually have selection and those phenotypes out there produce genotypes a new set of chromosomes and that completes our Loop that goes back in there and so that's the new generation sounds simple so if you're going to make this work of course you have a million choices as I'm going to emphasize over over and over again and one of your choices is for example how do you compute the fitness how do you compute the probability of survival to the Next Generation given the fitness so we have to go somehow from numbers like these to probabilities like those so I'm going to talk about several ways of doing it none of them are magic none of them was specified and stipulated by God is the right way uh but they have increasingly good properties with respect to this uh kind of um processing so the simplest thing you can do idea number one for computing the pro see what you do is you get this whole bag of of of individuals and you have to decide who's going to survive to the Next Generation so at each step everything in the bag has a probability of being the one you pick out and put into the Next Generation so at any step the sum of the probabilities for each of those guys goes is is one because that's how probability works probability of a complete set is added all up is probability of one so one thing you can do is you can say that the probability that you're going to draw individual I uh is H equal to or maybe proportional to the fitness of of that individual I haven't completed the expression so that's why I haven't completed the expression so it's not a probability yet because some over piece of I won't won't add up to one how could I ensure that it will add up to one oh that's easy right all I have to do is divide by the sum of the fitnesses over I so there's a probability measure that's produced from the fitnesses need to make sure that the fitnesses AR negative have to make sure the fitnesses are what aren't negative uh he says have to make sure the fitnesses aren't negative yeah it would be embarrassing if they were so we'll just truncate anything like that at zero you you got a lot of choices how you can calculate the fitness and maybe you will produce negative numbers in which case you have to think a little bit more about it so now what about an example well I'm going to show you an example why don't I show you the example what we're going to do is we're going to have a genetic algorithm that looks for an optimal value in a space and there's the space and you'll notice it's a bunch of contour lines bunch of hills in that space let me show you how that that space was produced the fitness uh is a function of X and Y and it's equal to the sign of some constant time x quantity squar time the S of some constant Yanti squar e to the + x + plus y ided by some constant so Sigma and Omega there are just in there so that it kind of makes a nice a nice picture for demonstration so there's a space and clearly where you want to be in this space is in the upper right hand corner that's the optimal value but we have a genetic algorithm doesn't know anything all it knows how to do is mutate and cross over so it's going to start off with a population of one it's a little red dot down there in the lower left so here's how it's going to evolve there's going to be a chromosome consisting of two numbers an X number and a y number like say3 and 7 here's another one which might be 6 and 0.2 so the mutation operator is going to take one of those values and change it a little bit so it might say well we'll take three and we'll make it. 2 and a crossover operation is going to exchange the X and Y values of pairs so if we have a cross over here then what we're going to get out from this one well we're going to get out a combination of these two and it's going to look like this because what we're going to do is we're going to take the x value of one and combine it with the yv value of the other one so this is going to be 0 2 my mutated value and 0 2 and this is going to be 6 and 7 so that's how my little genetic algorithm hack is going to work so having coded this up um we can now see how how it uh how it flows oh let's run it 10 Generations so the population is rapidly expanded to some fixed limit I forgot what it is 30 or so and we can run out 100 generations and so this seems to be getting stuck kind of right so what's the problem the problem is local Maxima this is fundamentally hill climbing mechanism you note that I've not included any crossover so far so if I do have crossover then if I've got a good x value and a good yvalue and I I I can cross them over and get them both into the same in the same uh in the same situation but nevertheless this thing doesn't seem to be working very well yeah that picture is just the contour lines of that function that's contour lines of that function so the the reason you see a lot of contour lines in the upper right is because it gets much higher because there's that exponential term it increases as you go up to the right so I don't know let's uh let's put some crossover in and repeat the experience one 100 Generations I don't know it just doesn't seem to be going anywhere sometimes it'll go right to the right to the global maximum sometimes it takes a long time it's it's got a random number gener in there so I have no control over it so it's going to get there um I couldn't tell whether the crossover was doing any good or not oh well here's one let's put in a little make this a little bit more complicated suppose that's the space now it's going to be in real trouble because they'll never get across that moat you know you would think that it will climb up to one one uh to the to the X maximum or the Y maximum but it's it's not going to do very well even with crossover it's just not going to do very well because it's climbing up those local Hills anybody got an idea about one simple thing we could do to to make it work better yeah you do you could uh increase the step size right let me see if that will help you know even that doesn't seem to help so we have to conclude uh do we conclude that this is a bad idea well we don't have to conclude it's a bad idea yet because we may just look at it and ask why five times and we might ask well maybe we can get a better Fitness a better mechanism in there to translate Fitness into probability of survival you know these you using that using this formula is kind of strange anyway because you know if you suppose temperature is one of your Fitness characteristics the hotter the better then the ratio of the probability that you will survive versus some the person next to you that ratio will depend on whether you're measuring the temperature in Celsius or Fahrenheit right because you you shifted the you shifted the origin that shifts the ratio that shifts the probability of success so it seems kind of strange to just take these things right straight into probabilities so a better idea idea number two is to say well H shoot maybe we don't care about what the actual fitnesses are all we really care about is the rank order of all the candidates so the candidate with the most Fitness will have the most probability of getting into the Next Generation the candidate with the second most Fitness will have the second highest probability and so on but we're not going to use the actual fitnesses themselves to make the determination instead what we're going to do with this mechanism number two this is the ranks space method is this we're going to say that the probability of the highest ranking individual getting into the next generation is some some constant P subc which of course you can select yet another Choice then if uh if that guy doesn't get selected the probability of the second highest ranking individual getting into the next generation is going to be the probability that that guy didn't get in there that's 1 minus P sub c times the same probability constant and so you can see how this is going P3 will be equal to 1 minus t sub c^ 2 * P sub c p sub nus1 will be equal to 1 minus that probability constant to the N minus n- 2 * P Sub C and then there's only one individual left I mean if you got through all these guys and haven't got anybody selected then you've got to select the last guy and so the probability you're going to select the last guy is going to be 1 minus P Sub C to the N minus one so it's it's it's the probability you've missed all of those guys in the first and nus one choices yeah it is honest to God see it's the prob this is the probability that this last guy is going to get selected it's not the probability of the last guy getting selected given that the others haven't been selected trust me it's right you think it ought to be one what what you think it ought to be one no you are rerolling the dice you got a probability each time except for the last time when of course you you have to take it there's nothing left there's no other choice yeah Lardo so when you jump from P of one to pie of two that Mak sense P to pie of three you're saying prob miss the first two choices yeah but the the second choice had probability oneus P not well think about it this way it's the probability you didn't choose the first two so the probability you didn't choose the first one is one minus P Sub C the probability you didn't choose the next one as well is because you you're choosing that next one with probability P subc it's it's it's the square of it okay so that's a that might be might work better let's give it a shot let's go back to our original space choice and uh reset and switch to a fitness the rank Fitness method and we'll run that 100 Generations whoa what happened there that was pretty fast maybe I use a big step size yeah that's a little bit more reasonable oops what happened it's really getting stuck on a local maximum so evidently I've choosed a constant piece of C uh such that it just drove it right up the the nearest Hill on the other hand if I change the step size a little bit maybe I can get it to spread out I sure did and now that it's um managed to evolve over there to find the maximum value now I can clamp down on the step size again and now it shows no more diversity is just locked onto that Global maximum so this is not unlike what evolution sometimes does it um sometimes uh species collapse into a state where they don't change for five or 600 million years like sharks for example uh sometimes uh they need um some times they only survive if they've got a lot of diversity built into their uh way of life so that they can adjust to Habitat changes now when you increase the step size because you're stuck on a local maximum it's like heating up a metal you make everything kind of vibrate more make bigger steps so this this kind of process where you may start with a big step size and then gradually reduce the step size is called simulated the kneeling because it's like letting a metal cool down so you start off with a big temperature big step size that kind of covers the space and then you slowly reduce the step size so you so you actually crawl up to the local maximum they're local maximum they're available so that seemed to work pretty well let's see if we can get it to work on um the harder problem with the moat so it's uh not doing very well better increase the step size no it's still kind of stuck it even though it even though it's got the capacity to cross over it's so stuck on that lower right hand corner it can't get up the that vertical Branch to get to a point where crossover will will produce a value up there in the upper right hand corner so we're still not home yet so what's the trouble the trouble is that the that the fitness meas the fitness mechanism is just driving things up the local maximum it's just terribly unfortunate what to do well here's something you can do you can say well if if the problem is we we've lost the diversity in our population then we can measure the diversity not only the fitness of the of the set of individuals we're selecting from but we can measure how different they are from the individuals we've already selected for the next population in other words we can factor in we can get a diverse population as well as a fit population if when we make our selection we consider not only their Fitness but how different they are from the individuals that have already been selected so that's going to be mechanism number three so now we have a a space and we can measure Fitness along one axis ordinary Fitness and this is ranks space Fitness so that's going to be P Sub C there'll always be some individual with prob with with the highest Fitness um and and and and over here that might not be P ofc actually but there'll be some individual with a maximum Fitness and any given step in the selection of an next population there'll be some individual that's maximally diverse from all of the individuals that have been selected for the Next Generation so far so where would what kind of individual would you like to pick for the Next Generation Well the one with the highest Fitness Rank and the one with the highest diversity rank so what you really like is You' like to have somebody right there and if you can't have somebody right there if there's nobody right there with maximum with a maximum Fitness and maximum diversity at the same time then maybe you can draw in ISO goodness lines like so which you're just how far you are from that ideal so let's summarize we got to pick some individuals for the next population when we pick the first individual all we're got to go on is is is how fit the individual is because there's nobody else of that next Generation after the first first individual is selected then we can look at our set of candidates and we can say which candidate would be more different from the set of things we've already selected than all the others that would get the highest diversity Rank and so on down the candidate list so let's see how that might work so we're going to use a combination of Fitness Rank and diversity Rank and we'll just use the simple one so far we use a small step size and we'll let this run a 100 generations to see what happens Bingo it crawls right up there because it's trying to keep itself spread out uses the diversity measurement to do that and at the same time it's seeking um High Fitness so that's why it's crawling up to the upper right hand corner but in the end that diversity piece of it is keeping the things spread out so suppose you're a shark or something you don't care about diversity anymore and we can just turn that off I think still running and go back to Fitness rank bingo so there you are you're stuck for 600 million years so let's see if this will handle the moat problem see our step size is still small we we just let this run so the diversity piece of it keeping it spread out pretty soon Bingo it's right it's right in there even it's cross that big moat because it's got the crossover mechanism that combines the best of the x's and the best of the Y's so that seems to work like work pretty well okay so see these are some of the uh these are some of the things that you can think about when you're thinking oh and of course we're a shark we're going to forget about diversity change the selection method from Fitness and diversity rank to just diversity it collapses down on to the highest hill yeah fball what oh it's just your question is how does step size translate into mutation oh uh instead of allowing myself to take steps as big as a tenth I might allow myself to take steps as big as 3/10 ACC According to some L distribution so what to say about all this it's um it's uh very seductive because it's nature right the trouble is it's naive nature and this is a as evolutionary theories go this is horrible this is naive so we would like to use real evolutionary theory except we don't have real evolutionary theory evolution is still a mystery some things are pretty obvious you can you can you can breed fast race horses that works just like so the trouble is we don't have any real good idea about how speciation takes place and how a lot of evolution works because all these chromosomes are connected to their phenotype consequences in very complicated ways that nobody fully understands so there's a great deal of magic in that genotype to phenotype transition that nobody really understands very well so when people write these programs that do um that that are in the in the style of so-called genetic algorithm they're they're taking they're uh taking a photograph of high school biology and and and spending a long time building programs based on that naive idea but that na that naive idea have has lots of places for intervention because you can look at all the things you can screw around with in the in that in that uh process of going from one generation to the next you got um by the way what is mutation do it's basically hill climbing right it's producing a little spread out and you're using the fitness thing to climb the hill so you got a lot of choices about how you handle that then you got a lot of choices about how much crossover you do and what does crossover do kind of combines features of strong features of multiple individuals into one individual Maybe um so you got all kinds of choices there and then your genotype to phenotype translation how do you interpret something like those zeros and ones as an if then rule for example is is something that's in the hands of the designer and then you got the rest of those things all of which are left up to the designer so in the end you really have to ask when you see an impressive demonstration you have to say where does the credit lie and I mean that pun intentionally because usually the people who are claiming the credit are lying about where it's coming from but nevertheless let me give you a couple of examples of where this has found actual Bonafide um practical application so when when you look for a practical application you might say well where in what kind of problem does a good front piece combined with a good back piece to produce a good thing overall and the answer is when you're making a plan so you might have a problem in planning that requires you to take a series of steps and you might have two plans Each of which is a series of steps and you might combine these to produce something new that's the front half of one and the back half of another so that's practical application number one and that requires you to interpret your chromosome as an indicator of the steps in a plan another example uh comes is um drawn from a europ project a student did for me some years ago came to me and said he's a freshman he came to me and said I want to do a year op project and I said have you taken 6034 and he said no and I said go away and he said I don't want to go away I don't want to do EUR project so I said have you uh read my book he said no I said well go away then and he said I don't want to go away I want to do a europ project so I said I don't have any europ projects He said that's okay I've got my own and and he was interested in he's a finance type guy so he was interested in uh whether he could build a rule based expert system that could predict the winners at horse races so his rule based expert system consisted of rules like this if X and Y then some conclusion if l and m uh then some kind of conclusion and from these he would produce rules like if x Prime that's a slightly mutated version of the of the X antecedent and M then some conclusion so it's mutation and crossover and he was able to produce a system that seemed to work as about as well as the handicappers in the newspapers so he started losing money at a less fast rate he uh is now doing something in the stock market they say doesn't talk so much about it though but interesting interesting application it came up with rules like if the sum of the jockey's weight and the post position is low that's good well that makes sense in the end because the jockey's weight is always between 100 and10 lbs and the post position's always between one and 10 or something so they were kind of Comm measure it values and a low one is good in fact not bad uh but neither of those I mean this is this is real stuff uh my company uses this sort of stuff to do um to do some planting work uh but uh neither of those is as impressive as a demonstration I'm about to show you that involves the evolution of creatures and these creatures consist of um block-- likee objects like so and they they combine like this and so on and and so how how can you make a creature like that from a 01 chromosome well some of the bits in the chromosome are are interpreted as the number of objects others are interpreted as the sizes of the objects others are interpreted as the structure of how the objects are articulated and still others are interpreted as uh fixing the control algorithm by which the creature operates so you see how that roughly goes would you like to see a film of that in action yes okay Sil always likes to see the films how did you measure that divers diversity in like in that graph I the question is how do I measure the diversity of the graph I did I did it the same way I measured the fitness that is to say I calculated the the distance the actual metric distance of of all of the candidates for the Next Generation from all of the candidates had already been selected I summed that up and from that sum I could rank them according to how different they were from the individuals that are already in the Next Generation so that gives me a rank and then from the rank I use that kind of calculation to determine a fitness a a probability of survival then I just combine the two kinds of probabilities so you always kept like every time that you selected something you cash those and you kept everything that you had already selected at least once I was always using the people the individuals that already been selected at every step so every step is a little different because it's working with a new set of individuals that have already been selected for the Next Generation okay all right so let's see how this works so this is uh showing the evolution of some swimming creatures and they're evolved according to how well they can swim how fast they can go some of them have quite exotic mechanisms and some of them quite natural that look like a sperm cell floating away there once you have these things evolving then of course you can get groups of them to EV evolved together so you saw already some that were that were evolving to swim these are evolving uh to uh move around on the land it's interesting this was uh done by Carl Sims um at who at the time was at a then thriving company thinking machines fresh spin-off from MIT so he was using a a vastly parallel computer super powerful for its day thousands of processors uh to do this and it was a demonstration of what you could do with lots of computing in the early stages of the U of the experimentation though it its notion of physics wasn't quite complete so some of the creatures evolved to move by hitting themselves in the chest and not knowing about the conservation of momentum they thought that was just great so here they are doing some further uh so you look at these and you say wow there must be something to this this is interesting these are complicated this one I think this is one of the ones that was trained to initially to swim and then to do a land Locomotion So eventually uh Carl got around to thinking about how to make these things evolve so that they would compete for food that's the fastest I think by the way of the land locomotiv something that was that was training them to evolving them to jump this is U evolving them to follow a little red dot some of them have quite exotic method have have stumbled ACR quite exotic methods as you can see seem to be flail in around but somehow managed sort of like uh watching people take a quiz making progress on it but now we're on to the food competition so some of them go for the food and some of them go to excluding their their opponent uh from the food uh not actually caring too much about whether they get it that's sort of uh what children do there's a kind of there's a kind of hockey hockey player now here's two hockey players watch this one suceeds reminds me a little bit of I don't know hockey rugby something like that sometimes they just kind of get kind of confused go right after they opponent forgetting about the food gives up these are I think these are overall winners in this elimination contest I can't quite get there okay so you look at that and you say wow that's cool genc algorithms must be the way to go I remember the first time I saw this film it was over in kesy I was walking out of the auditorium uh with Tomaso pagio and we looked at each other and we said the same thing simultaneously we didn't say that genetic algorithms are the way to go what we said was wow that space is rich in Solutions what we were Amazed by was not that g that simple minded genetic algorithms produce Solutions but that the space was so rich with solutions that almost any mechanism that was looking around in that space would find them but there's yet another way of thinking about and that is you could say wow look at how smart Carl Sims is because Carl Sims is the one who had his hands on all the lever all those choices that I keep that I kept emphasizing all those choices that enabled him to trick this thing in some sense into stumbling across the the the Solutions in a space that was guaranteed to be rich with Solutions so you have to ask um so first of all diversity is good we noticed that when we put diversity into the genetic algorithm calculations we were much better at finding Solutions but the next goal star idea that I'd really like to have you go away with is the idea that you have to ask where the credit lies does it lie with the Ingenuity of the programmer or with the value of the algorithm itself in this case impressive as it is the credit lies in the richness of the space and in the intelligence of the programmer not necessarily in the idea of genetic algorithms